<div class="docFinder">
    <div class="search-filters">
        <mat-form-field appearance="outline">
            <mat-label>Név</mat-label>
            <input matInput type="text" [(ngModel)]="nameValue">
        </mat-form-field>

        <mat-form-field appearance="outline">
            <mat-label>Város</mat-label>
            <select matNativeControl [(ngModel)]="selectedArea">
                <option value="">Összes város</option>
                <option *ngFor="let a of area" [value]="a.value">{{ a.value }}</option>
            </select>
        </mat-form-field>

        <mat-form-field appearance="outline">
            <mat-label>Szakterület</mat-label>
            <select matNativeControl [(ngModel)]="selectedSpec">
                <option value="">Összes szakterület</option>
                <option *ngFor="let s of specList" [value]="s.value">{{ s.value }}</option>
            </select>
        </mat-form-field>

        <span class="buttons">
            <button (click)="search()">{{ 'search' | i18next }}</button>
            <button (click)="removeFilters()">{{ 'delfilter' | i18next }}</button>
        </span>
    </div>

    <div *ngIf="role==='admin'" class="admin-section">
        <button color="accent" (click)="reqDoc()">Orvosi fiók regisztrálási kérések</button>
        <div *ngIf="reqOpen" class="requests-container">
            <div *ngFor="let doc of docs_temp" class="request-item">
                <div class="docCard">
                    <app-doctor [doc]="doc" [role]="role"></app-doctor>
                </div>
            </div>
        </div>
    </div>

    <div class="registration-section">
        <button (click)="openDocReg = !openDocReg">
            {{ openDocReg ? 'Mégse' : 'Orvosi fiók regisztrálása' }}
        </button>

        <div *ngIf="openDocReg" class="registration-form">
            <mat-form-field appearance="outline">
                <mat-label>Név</mat-label>
                <input matInput type="text" [(ngModel)]="newDocName" required>
            </mat-form-field>

            <mat-form-field appearance="outline">
                <mat-label>Telefonszám</mat-label>
                <input matInput type="text" [(ngModel)]="newDocPhone" required>
            </mat-form-field>

            <mat-form-field appearance="outline">
                <mat-label>Város</mat-label>
                <select matNativeControl [(ngModel)]="newDocCity" required>
                    <option value="">Válassz várost</option>
                    <option *ngFor="let a of area" [value]="a.value">{{ a.value }}</option>
                </select>
            </mat-form-field>

            <mat-form-field appearance="outline">
                <mat-label>Cím</mat-label>
                <input matInput type="text" [(ngModel)]="newDocAddress" required>
            </mat-form-field>

            <mat-form-field appearance="outline">
                <mat-label>Szakterület</mat-label>
                <select matNativeControl [(ngModel)]="newDocSpecialty" required>
                    <option value="">Válassz szakterületet</option>
                    <option *ngFor="let s of specList" [value]="s.value">{{ s.value }}</option>
                </select>
            </mat-form-field>

            <mat-form-field appearance="outline">
                <mat-label>Orvosi nyilvántartási szám</mat-label>
                <input matInput type="text" [(ngModel)]="newDocNumber" required>
                <mat-hint>5-6 számjegy</mat-hint>
            </mat-form-field>

            <div *ngIf="errorMsg" class="error-message">{{errorMsg}}</div>

            <button  (click)="registerDocProfile()" 
                    [disabled]="!newDocName || !newDocPhone || !newDocCity || !newDocAddress || !newDocSpecialty || !newDocNumber">
                Regisztráció
            </button>
        </div>
    </div>
    
    <div *ngIf="!loading" class="doctors-list">
        <div *ngIf="doctors.length === 0" class="no-results">
            Nincs találat a keresési feltételeknek megfelelő orvos.
        </div>

        <div *ngFor="let doc of doctors" class="doctor-item">
            <div class="docCard">
                <app-doctor [doc]="doc"></app-doctor>
            </div>
        </div>

        <mat-paginator [length]="totalItems" [pageSize]="pageSize" [pageSizeOptions]="[10, 20, 50]" (page)="onPageChange($event)">
        </mat-paginator>
    </div>
</div>